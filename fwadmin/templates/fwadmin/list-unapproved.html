{% extends "base.html" %}
{% load i18n %}
{% load url from future %}

{% block brand %}
{% trans "Unapproved Hosts" %}
{% endblock %}

{% block content %}

<script type="text/javascript">
    $(document).ready(function () {
        $('.filter').searchTable('#table_hosts', {
            searchIn: [1,3,4] // owner, ip, rules
        });
    });
</script>

<h2>{% trans "All unapproved hosts" %}</h2>
<div class="control-group pull-right col-md-4">
    <input type="text" class="form-control filter" placeholder="filter"/>
</div>
{% if all_hosts %}
    <table class="table" id="table_hosts">
      <thead>
      <tr>
        <th>{% trans "Owner" %}</th>
        <th>{% trans "Host Description" %}</th>
        <th>{% trans "IP" %}</th>
        <th>{% trans "Rules" %}</th>
        <th>{% trans "Approve Link" %}</th>
      </tr>
      </thead>
      <tbody>
      {% for host in all_hosts  %}
      <tr>
        <td>{{ host.owner }}</td>
        <td>{{ host.name }}</td>
        <td>{{ host.ip }}</td>
        <td>
	  {# XXX: meeeeh, is there a better way to do this than to loop here N-times ? #}
	  {% for rule in host.get_rules_for_host %}
	      <p>name:{{ rule.name }} from:{{ rule.from_net }} permit:{{ rule.permit }} protocol:{{ rule.ip_protocol }} port:{{ rule.port }}
	      </p>
	  {% endfor %}
        </td>
        <td> 
	  <form	action={% url 'fwadmin:moderator_approve_host' host.pk %}
		method="post">
	    {% csrf_token %}
	    <input type="submit" value={% trans "Approve" %} class="btn btn-primary">
	  </form>
	</td>
      </tr>
      {% endfor %}
      </tbody>
    </table>
{% else %}
    <p>{% trans "No unapproved hosts." %}</p>
{% endif %}

{% endblock %}
